{"remainingRequest":"D:\\Projects\\blog_admin\\node_modules\\babel-loader\\lib\\index.js!D:\\Projects\\blog_admin\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Projects\\blog_admin\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\Projects\\blog_admin\\src\\store\\modules\\user.js","mtime":1571579220257},{"path":"D:\\Projects\\blog_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Projects\\blog_admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Projects\\blog_admin\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import { login, getUserInfo as _getUserInfo } from '@/utils/api';\nimport { getToken, setToken, removeToken } from '@/utils/auth';\nvar state = {\n  token: getToken(),\n  name: ''\n};\nvar mutations = {\n  SET_TOKEN: function SET_TOKEN(state, token) {\n    state.token = token;\n  },\n  SET_NAME: function SET_NAME(state, name) {\n    state.name = name;\n  }\n};\nvar actions = {\n  loginByUsername: function loginByUsername(_ref, user) {\n    var commit = _ref.commit;\n    var username = user.username,\n        password = user.password;\n    return new Promise(function (resolve, reject) {\n      login({\n        username: username,\n        password: password\n      }).then(function (response) {\n        var data = response.data.data;\n        setToken(data.token);\n        commit('SET_TOKEN', data.token);\n        resolve();\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  getUserInfo: function getUserInfo(_ref2) {\n    var commit = _ref2.commit;\n    return new Promise(function (resolve, reject) {\n      _getUserInfo().then(function (response) {\n        var data = response.data;\n\n        if (!data) {\n          reject(new Error('验证失败，请重新登陆'));\n        }\n\n        commit('SET_NAME', data.username);\n        resolve(data);\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  logout: function logout(_ref3) {\n    var commit = _ref3.commit;\n    return new Promise(function (resolve, reject) {\n      try {\n        removeToken();\n        commit('SET_TOKEN', '');\n        resolve();\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n};\nexport default {\n  namespaced: true,\n  state: state,\n  mutations: mutations,\n  actions: actions\n};",{"version":3,"sources":["D:\\Projects\\blog_admin\\src\\store\\modules\\user.js"],"names":["login","getUserInfo","getToken","setToken","removeToken","state","token","name","mutations","SET_TOKEN","SET_NAME","actions","loginByUsername","user","commit","username","password","Promise","resolve","reject","then","response","data","catch","error","Error","logout","namespaced"],"mappings":"AAAA,SAASA,KAAT,EAAgBC,WAAW,IAAXA,YAAhB,QAAmC,aAAnC;AACA,SAASC,QAAT,EAAmBC,QAAnB,EAA6BC,WAA7B,QAAgD,cAAhD;AAEA,IAAMC,KAAK,GAAG;AACZC,EAAAA,KAAK,EAAEJ,QAAQ,EADH;AAEZK,EAAAA,IAAI,EAAE;AAFM,CAAd;AAKA,IAAMC,SAAS,GAAG;AAChBC,EAAAA,SADgB,qBACLJ,KADK,EACEC,KADF,EACS;AACvBD,IAAAA,KAAK,CAACC,KAAN,GAAcA,KAAd;AACD,GAHe;AAIhBI,EAAAA,QAJgB,oBAINL,KAJM,EAICE,IAJD,EAIO;AACrBF,IAAAA,KAAK,CAACE,IAAN,GAAaA,IAAb;AACD;AANe,CAAlB;AASA,IAAMI,OAAO,GAAG;AACdC,EAAAA,eADc,iCACeC,IADf,EACqB;AAAA,QAAhBC,MAAgB,QAAhBA,MAAgB;AAAA,QACzBC,QADyB,GACFF,IADE,CACzBE,QADyB;AAAA,QACfC,QADe,GACFH,IADE,CACfG,QADe;AAEjC,WAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCnB,MAAAA,KAAK,CAAC;AAAEe,QAAAA,QAAQ,EAAEA,QAAZ;AAAsBC,QAAAA,QAAQ,EAAEA;AAAhC,OAAD,CAAL,CACGI,IADH,CACQ,UAAAC,QAAQ,EAAI;AAChB,YAAMC,IAAI,GAAGD,QAAQ,CAACC,IAAT,CAAcA,IAA3B;AACAnB,QAAAA,QAAQ,CAACmB,IAAI,CAAChB,KAAN,CAAR;AACAQ,QAAAA,MAAM,CAAC,WAAD,EAAcQ,IAAI,CAAChB,KAAnB,CAAN;AACAY,QAAAA,OAAO;AACR,OANH,EAOGK,KAPH,CAOS,UAAAC,KAAK,EAAI;AACdL,QAAAA,MAAM,CAACK,KAAD,CAAN;AACD,OATH;AAUD,KAXM,CAAP;AAYD,GAfa;AAgBdvB,EAAAA,WAhBc,8BAgBW;AAAA,QAAVa,MAAU,SAAVA,MAAU;AACvB,WAAO,IAAIG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtClB,MAAAA,YAAW,GACRmB,IADH,CACQ,UAAAC,QAAQ,EAAI;AAChB,YAAMC,IAAI,GAAGD,QAAQ,CAACC,IAAtB;;AACA,YAAI,CAACA,IAAL,EAAW;AACTH,UAAAA,MAAM,CAAC,IAAIM,KAAJ,CAAU,YAAV,CAAD,CAAN;AACD;;AACDX,QAAAA,MAAM,CAAC,UAAD,EAAaQ,IAAI,CAACP,QAAlB,CAAN;AACAG,QAAAA,OAAO,CAACI,IAAD,CAAP;AACD,OARH,EASGC,KATH,CASS,UAAAC,KAAK,EAAI;AACdL,QAAAA,MAAM,CAACK,KAAD,CAAN;AACD,OAXH;AAYD,KAbM,CAAP;AAcD,GA/Ba;AAgCdE,EAAAA,MAhCc,yBAgCM;AAAA,QAAVZ,MAAU,SAAVA,MAAU;AAClB,WAAO,IAAIG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,UAAI;AACFf,QAAAA,WAAW;AACXU,QAAAA,MAAM,CAAC,WAAD,EAAc,EAAd,CAAN;AACAI,QAAAA,OAAO;AACR,OAJD,CAIE,OAAOM,KAAP,EAAc;AACdL,QAAAA,MAAM,CAACK,KAAD,CAAN;AACD;AACF,KARM,CAAP;AASD;AA1Ca,CAAhB;AA6CA,eAAe;AACbG,EAAAA,UAAU,EAAE,IADC;AAEbtB,EAAAA,KAAK,EAALA,KAFa;AAGbG,EAAAA,SAAS,EAATA,SAHa;AAIbG,EAAAA,OAAO,EAAPA;AAJa,CAAf","sourcesContent":["import { login, getUserInfo } from '@/utils/api'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\n\r\nconst state = {\r\n  token: getToken(),\r\n  name: ''\r\n}\r\n\r\nconst mutations = {\r\n  SET_TOKEN (state, token) {\r\n    state.token = token\r\n  },\r\n  SET_NAME (state, name) {\r\n    state.name = name\r\n  }\r\n}\r\n\r\nconst actions = {\r\n  loginByUsername ({ commit }, user) {\r\n    const { username, password } = user\r\n    return new Promise((resolve, reject) => {\r\n      login({ username: username, password: password })\r\n        .then(response => {\r\n          const data = response.data.data\r\n          setToken(data.token)\r\n          commit('SET_TOKEN', data.token)\r\n          resolve()\r\n        })\r\n        .catch(error => {\r\n          reject(error)\r\n        })\r\n    })\r\n  },\r\n  getUserInfo ({ commit }) {\r\n    return new Promise((resolve, reject) => {\r\n      getUserInfo()\r\n        .then(response => {\r\n          const data = response.data\r\n          if (!data) {\r\n            reject(new Error('验证失败，请重新登陆'))\r\n          }\r\n          commit('SET_NAME', data.username)\r\n          resolve(data)\r\n        })\r\n        .catch(error => {\r\n          reject(error)\r\n        })\r\n    })\r\n  },\r\n  logout ({ commit }) {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        removeToken()\r\n        commit('SET_TOKEN', '')\r\n        resolve()\r\n      } catch (error) {\r\n        reject(error)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n"]}]}